(function(e){var t=function(t,n){var r=/^(.*)(\d)+$/i;var i=e(t);var s={limit:999,cloneThis:".toclone",valueClone:false,dataClone:false,deepClone:false,cloneButton:".clone",deleteButton:".delete",clonePosition:"after"};var o=e.extend(s,n||{});this.getOption=function(){return o};this.setOption=function(t){e.extend(o,t||{})};var u=i.find(o.cloneThis).length;if(u<=2){e(o.deleteButton).eq(0).hide()}i.on("click",o.cloneButton,function(t){t.preventDefault();i.trigger("clone",[e(this)])});i.on("clone",function(t,n){var r=i.find(o.cloneThis).length;if(r<o.limit){$toclone=n.closest(o.cloneThis);i.trigger("clone_before_clone",$toclone);$newclone=$toclone.clone({withDataAndEvents:o.dataClone,deepWithDataAndEvents:o.deepClone});$newclone.find("input, textarea, select").each(function(){if(!o.valueClone){e(this).val("")}i.trigger("clone_form_input",n,$toclone,$newclone)});i.trigger("clone_after_clone",$toclone,$newclone);i.trigger("clone_before_append",$newclone);if(o.clonePosition!="after"){$toclone.before($newclone)}else{$toclone.after($newclone)}a();i.trigger("clone_after_append",$newclone)}else{i.trigger("clone_limit",o.limit,$toclone)}if(r>=1){e(o.deleteButton).show()}if(r>=o.limit-1){e(o.cloneButton).eq(r).hide()}});i.on("click",o.deleteButton,function(t){t.preventDefault();i.trigger("clone_delete",[e(this)])});i.on("clone_delete",function(t,n){var r=i.find(o.cloneThis).length;if(r>1){$todelete=n.closest(o.cloneThis);i.trigger("clone_before_delete",$todelete);$todelete.remove();i.trigger("clone_after_delete")}if(r<=2){e(o.deleteButton).eq(0).hide()}if(r<=o.limit){e(o.cloneButton).show()}});var a=function(){if(o.serializeID!==true){return}mainid=i.find(o.cloneThis).first().attr("id");e(o.cloneThis).each(function(t){if(t!==0){j=t}else{j=""}if(e(this).attr("id")){e(this).attr("id",mainid+j)}e(this).find("*").each(function(){var t=e(this).attr("id");if(t){var n=t.match(r);if(n&&n.length===3){e(this).attr("id",n[1]+j)}else{e(this).attr("id",t+j)}}})})}};e.fn.cloneya=function(n){return this.each(function(){var r=e(this);if(r.data("cloneya"))return;var i=new t(this,n);r.data("cloneya",i)})}})(jQuery)
